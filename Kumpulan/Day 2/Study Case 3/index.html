<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Data Pengajuan Leasing</title>
  <style>
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }

    th, td {
      padding: 8px 12px;
      border: 1px solid #ddd;
    }

    th {
      background-color: #f2f2f2;
    }
  </style>
</head>
<body>
  <h2>Daftar Pengajuan Leasing</h2>

  <table id="tabelPengajuan">
    <thead>
      <tr>
        <th>No</th>
        <th>Nama</th>
        <th>Umur</th>
        <th>DP</th>
        <th>Harga Motor</th>
      </tr>
    </thead>
    <tbody>
      <!-- Data akan dimasukkan ke sini -->
    </tbody>
  </table>

  <h2>Daftar Pengajuan Leasing: Approved + Usia 21-55</h2>

  <table id="tabelPengajuan2">
    <thead>
      <tr>
        <th>No</th>
        <th>Nama</th>
        <th>Umur</th>
        <th>DP</th>
        <th>Harga Motor</th>
      </tr>
    </thead>
    <tbody>
      <!-- Data akan dimasukkan ke sini -->
    </tbody>
  </table>

  <h2>Daftar Pengajuan Leasing: Cicilan Bulanan</h2>

  <table id="tabelPengajuan3">
        <thead>
        <tr>
            <th>No</th>
            <th>Nama</th>
            <th>Cicilan Bulanan</th>
        </tr>
        </thead>
        <tbody>
        </tbody>
  </table>

  <script>
    async function tampilkanData() {
      try {
        const res = await fetch("https://68598a7a138a18086dfec989.mockapi.io/dummy-fif/DummyDataUser");
        console.log('res: ', res)
        const data = await res.json();
        console.log('Data: ', data)

        const tbody = document.querySelector("#tabelPengajuan tbody");
        tbody.innerHTML = ""; // kosongkan dulu

        data.forEach((pengajuan, index) => {
          const row = `
            <tr>
              <td>${index + 1}</td>
              <td>${pengajuan.name}</td>
              <td>${pengajuan.age}</td>
              <td>Rp ${parseInt(pengajuan.dp).toLocaleString()}</td>
              <td>Rp ${parseInt(pengajuan.price).toLocaleString()}</td>
            </tr>
          `;
          tbody.innerHTML += row;
        });
      } catch (err) {
        console.error("Gagal mengambil data:", err);
      }
    }

    async function tampilkanData2() {
      try {
        const res = await fetch("https://68598a7a138a18086dfec989.mockapi.io/dummy-fif/DummyDataUser");
        console.log('res: ', res)
        const data = await res.json();
        console.log('Data: ', data)
    
        const tbody = document.querySelector("#tabelPengajuan2 tbody");
        tbody.innerHTML = ""; // kosongkan dulu

        const filter = data.filter(
            pengajuan => pengajuan.age >= 21 && pengajuan.age <= 55
        )
    
        filter.forEach((pengajuan, index) => {
                const row = `
                  <tr>
                    <td>${index + 1}</td>
                    <td>${pengajuan.name}</td>
                    <td>${pengajuan.age}</td>
                    <td>Rp ${parseInt(pengajuan.dp).toLocaleString()}</td>
                    <td>Rp ${parseInt(pengajuan.price).toLocaleString()}</td>
                  </tr>
                `;
                tbody.innerHTML += row;
        });
    
      } catch (err) {
        console.error("Gagal mengambil data:", err);
      }
    }

    async function tampilkanData3() {
      try {
        const res = await fetch("https://68598a7a138a18086dfec989.mockapi.io/dummy-fif/DummyDataUser");
        console.log('res: ', res)
        const data = await res.json();
        console.log('Data: ', data)
    
        const tbody = document.querySelector("#tabelPengajuan3 tbody");
        tbody.innerHTML = ""; // kosongkan dulu
    
        const filter = data.filter(
            pengajuan => pengajuan.age >= 21 && pengajuan.age <= 55
        )
        
        filter.forEach((pengajuan, index) => {
            const harga = parseFloat(pengajuan.price);
            const dp = pengajuan.price * 0.3;
            const pinjaman = pengajuan.price - dp;
            const bunga = 0.1;
            const tenor = 12;
            
            const totalPembayaran = pinjaman + (pinjaman * bunga);
            const cibu = totalPembayaran / tenor;

    
            const row = `
                <tr>
                <td>${index + 1}</td>
                <td>${pengajuan.name}</td>
                <td>Rp ${Math.round(cibu).toLocaleString()}</td>
                </tr>
            `;
            tbody.innerHTML += row;
            
        });
    
    
      } catch (err) {
        console.error("Gagal mengambil data:", err);
      }
    }

    // Panggil fungsi otomatis saat halaman selesai dimuat
    document.addEventListener("DOMContentLoaded", () => {
        tampilkanData();
        tampilkanData2();
        tampilkanData3();
    });
  </script>
</body>
</html>